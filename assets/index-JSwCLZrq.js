import{u as L}from"./core-DDcx4W_R.js";import{e as p}from"./eventBus-CGRXT3Tn.js";import{_ as B}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{e as i,f as H,h as P,u as I,o as f,c as m,a as v,g as _,n as g}from"./index-CvtKfrht.js";const A=[66,67,68,69,71,76,80,83,85,86,88,89,90],D=["contenteditable","innerHTML"],E={key:1,class:"v-text preview"},R=["innerHTML"],S={__name:"index",props:{prototies:{type:String,required:!0,default:""},element:{type:Object,default:()=>{}},linkage:{type:Object,default:()=>{}}},emits:["onInput"],setup(n,{emit:y}){const c=n,d=y,r=L(),t=i(!1),a=i(null),s=i(!1),x=e=>{const l=window.getSelection(),o=document.createRange();o.selectNodeContents(e),l.removeAllRanges(),l.addRange(o)},k=()=>{c.element.isLock||(t.value=!0,x(a.value))},C=e=>{e.preventDefault();const o=e.clipboardData.getData("text/plain")||"";o!==""&&document.execCommand("insertText",!1,o),d("onInput",a.value,e.target.innerHTML)},h=e=>{t.value&&e.stopPropagation()},M=e=>{e.target.innerHTML,t.value=!1},T=e=>{d("onInput",a.value,e.target.innerHTML)},b=e=>{t.value&&e.stopPropagation(),e.keyCode==17?s.value=!0:(s.value&&t.value&&A.includes(e.keyCode)||e.keyCode==46)&&e.stopPropagation()},w=e=>{t.value&&e.stopPropagation(),e.keyCode==17&&(s.value=!1)};function u(){r.curComponent.id!==c.element.id&&(t.value=!1)}return H(()=>{p.on("componentClick",u)}),P(()=>{p.off("componentClick",u)}),(e,l)=>I(r).editMode==="edit"?(f(),m("div",{key:0,class:"v-text",onKeydown:b,onKeyup:w},[v("div",{ref_key:"textEditRef",ref:a,contenteditable:t.value,class:_({"can-edit":t.value}),tabindex:"0",style:g({verticalAlign:n.element.style.verticalAlign,padding:n.element.style.padding+"px"}),onDblclick:k,onPaste:C,onMousedown:h,onBlur:M,onInput:T,innerHTML:n.element.propValue},null,46,D)],32)):(f(),m("div",E,[v("div",{style:g({verticalAlign:n.element.style.verticalAlign,padding:n.element.style.padding+"px"}),innerHTML:n.element.propValue},null,12,R)]))}},N=B(S,[["__scopeId","data-v-06c559bd"]]);export{N as default};
