import{u as L}from"./core-eeR1yz6c.js";import{e as u}from"./eventBus-CGRXT3Tn.js";import{_ as b}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{e as i,f as B,h as H,u as P,o as p,c as f,a as m,g as I,n as v}from"./index-BGIuNLao.js";const A=[66,67,68,69,71,76,80,83,85,86,88,89,90],D=["contenteditable","innerHTML"],E={key:1,class:"v-text preview"},R=["innerHTML"],S={__name:"index",props:{prototies:{type:String,required:!0,default:""},element:{type:Object,default:()=>{}},linkage:{type:Object,default:()=>{}}},emits:["onInput"],setup(g,{emit:y}){const n=g,c=y,r=L(),t=i(!1),a=i(null),s=i(!1),_=e=>{const l=window.getSelection(),o=document.createRange();o.selectNodeContents(e),l.removeAllRanges(),l.addRange(o)},x=()=>{n.element.isLock||(t.value=!0,_(a.value))},k=e=>{e.preventDefault();const o=e.clipboardData.getData("text/plain")||"";o!==""&&document.execCommand("insertText",!1,o),c("onInput",a.value,e.target.innerHTML)},C=e=>{t.value&&e.stopPropagation()},h=e=>{e.target.innerHTML,t.value=!1},M=e=>{c("onInput",a.value,e.target.innerHTML)},T=e=>{t.value&&e.stopPropagation(),e.keyCode==17?s.value=!0:(s.value&&t.value&&A.includes(e.keyCode)||e.keyCode==46)&&e.stopPropagation()},w=e=>{t.value&&e.stopPropagation(),e.keyCode==17&&(s.value=!1)};function d(){r.curComponent.id!==n.element.id&&(t.value=!1)}return B(()=>{u.on("componentClick",d)}),H(()=>{u.off("componentClick",d)}),(e,l)=>P(r).editMode==="edit"?(p(),f("div",{key:0,class:"v-text",onKeydown:T,onKeyup:w},[m("div",{ref_key:"textEditRef",ref:a,contenteditable:t.value,class:I({"can-edit":t.value}),tabindex:"0",style:v({verticalAlign:n.element.style.verticalAlign,padding:n.element.style.padding+"px"}),onDblclick:x,onPaste:k,onMousedown:C,onBlur:h,onInput:M,innerHTML:n.element.propValue},null,46,D)],32)):(p(),f("div",E,[m("div",{style:v({verticalAlign:n.element.style.verticalAlign,padding:n.element.style.padding+"px"}),innerHTML:n.element.propValue},null,12,R)]))}},N=b(S,[["__scopeId","data-v-48fcc810"]]);export{N as default};
